# –ì–æ—Å—Ç–∏–Ω–∏—Ü–∞ - –Ω–∞—Å—Ç–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
### (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö)
## –°–∫—Ä–∏–Ω—à–æ—Ç—ã

![–ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ](images/1.jpg)
![–ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±–ª–∏—Ü](images/2.jpg)
![–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ CTE](images/3.jpg)

---

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ *¬´–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö¬ª*.  
–ü—Ä–µ–¥–º–µ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å ‚Äî **–≥–æ—Å—Ç–∏–Ω–∏—Ü–∞** (–∫–ª–∏–µ–Ω—Ç—ã, –Ω–æ–º–µ—Ä–∞, —Ä–∞–∑–º–µ—â–µ–Ω–∏—è).

–°—Ç–µ–∫:

- **Python 3.12**
- **PySide6** ‚Äî –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–Ω–∞—Å—Ç–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
- **PostgreSQL** ‚Äî –°–£–ë–î
- **psycopg2** ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- **python-dotenv** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑ `.env`

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö, –Ω–æ–º–µ—Ä–∞—Ö –∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è—Ö, –Ω–æ –∏:

- —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Ç–∏–ø–∞–º–∏ (ENUM –∏ —Å–æ—Å—Ç–∞–≤–Ω—ã–µ —Ç–∏–ø—ã);
- –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü;
- –∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ `SELECT`-–∑–∞–ø—Ä–æ—Å—ã —Å `JOIN`, –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π, `CASE`, `COALESCE`, `NULLIF`;
- —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫–∞–∫ `VIEW`, `MATERIALIZED VIEW` –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ CTE;
- —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º–∏ –∏ CTE —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä.

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/hsugvusrihgvir/hotel_app
cd hotel_app
```

### 2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
python -m venv .venv
# Windows:
.venv\Scripts\activate
# Linux / macOS:
source .venv/bin/activate

pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (—Ä—è–¥–æ–º —Å `main.py`) –∏ —É–∫–∞–∑–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```env
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=hotel_db
```

–ö–ª–∞—Å—Å `Database` —Å–∞–º –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Ö –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î.

### 4. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å—Ö–µ–º—É –ë–î

–í –ø—Ä–æ–µ–∫—Ç–µ –µ—Å—Ç—å –¥–≤–∞ SQL-—Å–∫—Ä–∏–ø—Ç–∞:

- `db/schema.sql` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü –±–µ–∑ —Å–±—Ä–æ—Å–∞ —Å—Ö–µ–º—ã;
- `db/reset.sql` ‚Äî –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —Å—Ö–µ–º—ã `public` (DROP SCHEMA + —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü + –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ).

–ë–∞–∑–æ–≤—É—é —Å—Ö–µ–º—É –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏.

**–í–∞—Ä–∏–∞–Ω—Ç A ‚Äî –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`python main.py`).
2. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É **¬´–°–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—É –∏ —Ç–∞–±–ª–∏—Ü—ã¬ª**.
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **¬´–°–±—Ä–æ—Å–∏—Ç—å –±–∞–∑—É¬ª**, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å `reset.sql` –∏ –ø–æ–ª—É—á–∏—Ç—å —á–∏—Å—Ç—É—é —Å—Ö–µ–º—É —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

**–í–∞—Ä–∏–∞–Ω—Ç B ‚Äî –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ psql / DBeaver**

```bash
psql -h localhost -U postgres -d hotel_db -f db/reset.sql
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã)

- `main.py` ‚Äî –≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: —Å–æ–∑–¥–∞—ë—Ç `QApplication`, –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ë–î –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `MainWindow`.
- `app/main_window.py` ‚Äî –ª–æ–≥–∏–∫–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é.
- `app/ui/ui_main_window.py` ‚Äî –≤–µ—Ä—Å—Ç–∫–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞: —Ç—ë–º–Ω–∞—è —Ç–µ–º–∞, —Ç—Ä–∏ –±–ª–æ–∫–∞ (¬´–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î¬ª, ¬´–†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏¬ª, ¬´–ó–∞–ø—Ä–æ—Å—ã –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è¬ª) –∏ —Ñ—É—Ç–µ—Ä.
- `app/ui/enter_data_dialog.py` ‚Äî –¥–∏–∞–ª–æ–≥ –¥–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö.
- `app/ui/quick_view_window.py` ‚Äî **–ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä**: –≤—ã–±–æ—Ä —Ç–∞–±–ª–∏—Ü—ã, –ø—Ä–æ—Å—Ç—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.
- `app/ui/join_master_dialog.py` ‚Äî –º–∞—Å—Ç–µ—Ä –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–≥–æ `JOIN`: –≤—ã–±–æ—Ä –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü, –∫–ª—é—á–µ–π –∏ —Ç–∏–ø–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.
- `app/ui/data_window.py` ‚Äî **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π SELECT**: –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ —Å `JOIN`, —Ñ–∏–ª—å—Ç—Ä–∞–º–∏, –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π, –æ–∫–æ–Ω–Ω—ã–º–∏ –∏ —Å—Ç—Ä–æ–∫–æ–≤—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏, `CASE/NULL`.
- `app/ui/alter_table_window.py` ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü (`ALTER TABLE`).
- `app/ui/types_window.py` ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ç–∏–ø–æ–≤ PostgreSQL (ENUM –∏ COMPOSITE).
- `app/ui/views_window.py` ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä VIEW / MATERIALIZED VIEW / CTE.
- `app/ui/cte_builder_window.py` ‚Äî –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä CTE-–ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤–∏–¥–∂–µ—Ç–æ–≤ WHERE/HAVING.
- `app/ui/collapsible_section.py` ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –≤–∏–¥–∂–µ—Ç ¬´—Å–∫–ª–∞–¥—ã–≤–∞—é—â–∏—Ö—Å—è¬ª —Å–µ–∫—Ü–∏–π –¥–ª—è –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.
- `app/ui/cte_storage.py` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö CTE (`GLOBAL_SAVED_CTES: Dict[str, str]`), –æ–±—â–µ–µ –¥–ª—è DataWindow –∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π.
- `app/ui/theme.py` ‚Äî –æ–±—â–∞—è —Ç—ë–º–Ω–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –∏ –ø–∞–ª–∏—Ç—Ä–∞ –¥–ª—è –≤—Å–µ—Ö –æ–∫–æ–Ω.
- `app/log/log.py` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–≥–µ—Ä–∞ `app`, –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å –∏ –≤ —Ñ–∞–π–ª `app_YYYY-MM-DD.log`.
- `app/db/db.py` ‚Äî –∫–ª–∞—Å—Å `Database`: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã (DDL, SELECT, JOIN, CTE, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è, —Ä–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Ç–∏–ø–∞–º–∏).
- `db/schema.sql`, `db/reset.sql` ‚Äî —Å–∫—Ä–∏–ø—Ç—ã —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ç–∏–ø–æ–≤, —Ç–∞–±–ª–∏—Ü –∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

---

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ

–ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–æ –Ω–∞ —Ç—Ä–∏ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –±–ª–æ–∫–∞:

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î**
   - **¬´–°–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—É –∏ —Ç–∞–±–ª–∏—Ü—ã¬ª** ‚Äî –ø–µ—Ä–≤–∏—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã –∏ —Ç–∞–±–ª–∏—Ü.
   - **¬´–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É¬ª** ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –æ–∫–Ω–æ `AlterTableWindow` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ `ALTER TABLE`.
   - **¬´–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–∏–ø—ã¬ª** ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ç–∏–ø–æ–≤ (ENUM –∏ COMPOSITE).
   - **¬´–°–±—Ä–æ—Å–∏—Ç—å –±–∞–∑—É¬ª** ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç `reset.sql`, –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—è —Å—Ö–µ–º—É `public` –∏ –Ω–∞–ø–æ–ª–Ω—è—è –µ—ë —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

2. **–†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏**
   - **¬´–ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä¬ª** ‚Äî –ø—Ä–æ—Å—Ç–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã, –∑–∞–¥–∞–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ.
   - **¬´–í–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ¬ª** ‚Äî –¥–∏–∞–ª–æ–≥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö (–∫–ª–∏–µ–Ω—Ç—ã, –Ω–æ–º–µ—Ä–∞, —Ä–∞–∑–º–µ—â–µ–Ω–∏—è).
   - **¬´–ü–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ¬ª** ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π SELECT** (DataWindow) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `JOIN`, —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞–º–∏.

3. **–ó–∞–ø—Ä–æ—Å—ã –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è**
   - **¬´–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ CTE¬ª** ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä VIEW / MATERIALIZED VIEW / CTE.
   - **¬´–°–æ–∑–¥–∞—Ç—å CTE (–ø–æ–¥–∑–∞–ø—Ä–æ—Å)¬ª** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä CTE, –∑–∞—Ç–æ—á–µ–Ω–Ω—ã–π –ø–æ–¥ —Å–ª–æ–∂–Ω—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã.

---

### –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–°—Ö–µ–º–∞ –æ–ø–∏—Å–∞–Ω–∞ –≤ `schema.sql` / `reset.sql` –∏ –≤–∫–ª—é—á–∞–µ—Ç:

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π ENUM-—Ç–∏–ø `comfort_enum ('standard', 'semi_lux', 'lux')`.
- –¢–∞–±–ª–∏—Ü–∞ **clients** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã –≥–æ—Å—Ç–∏–Ω–∏—Ü—ã (–§–ò–û, –ø–∞—Å–ø–æ—Ä—Ç, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, –ø—Ä–∏–∑–Ω–∞–∫ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞, –¥–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏).
- –¢–∞–±–ª–∏—Ü–∞ **rooms** ‚Äî –Ω–æ–º–µ—Ä–∞ (–Ω–æ–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã, –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å, –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ—Å—Ç—å, —Ü–µ–Ω–∞, –º–∞—Å—Å–∏–≤ —É–¥–æ–±—Å—Ç–≤ `TEXT[]` —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –Ω–∞ —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞).
- –¢–∞–±–ª–∏—Ü–∞ **stays** ‚Äî —Ä–∞–∑–º–µ—â–µ–Ω–∏—è (–∫–ª–∏–µ–Ω—Ç, –Ω–æ–º–µ—Ä, –¥–∞—Ç—ã –∑–∞–µ–∑–¥–∞/–≤—ã–µ–∑–¥–∞, –æ–ø–ª–∞—á–µ–Ω –ª–∏, –∑–∞–º–µ—Ç–∫–∞, —Å—Ç–∞—Ç—É—Å, –ø—Ä–æ–≤–µ—Ä–∫–∞ `check_out > check_in`).

–°–∫—Ä–∏–ø—Ç `reset.sql` —Ç–∞–∫–∂–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –Ω–æ–º–µ—Ä–æ–≤ –∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–π, —á—Ç–æ–±—ã —Å—Ä–∞–∑—É —É–≤–∏–¥–µ—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

---

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π SELECT (–æ–∫–Ω–æ DataWindow)

–û–∫–Ω–æ `DataWindow` ‚Äî —ç—Ç–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å–ª–æ–∂–Ω—ã—Ö `SELECT`-–∑–∞–ø—Ä–æ—Å–æ–≤ —Å `JOIN`, —Ñ–∏–ª—å—Ç—Ä–∞–º–∏, –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Å—Ç—Ä–æ–∫–æ–≤—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏.

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- –í—ã–±–æ—Ä —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è `SELECT` —á–µ—Ä–µ–∑ —Å–ø–∏—Å–æ–∫ —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏.
- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π `WHERE`:
  - –≤—ã–±–æ—Ä –∫–æ–ª–æ–Ω–∫–∏ –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ (`=`, `<>`, `>`, `<`, `>=`, `<=`, `LIKE`, `ILIKE`);
  - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `LIKE` –∑–∞–ø—Ä–µ—â—ë–Ω –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö/–¥–∞—Ç –∏ –±—É–ª–µ–≤—ã—Ö –ø–æ–ª–µ–π, —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ);
  - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ `%...%` –¥–ª—è —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞.
- –ü–æ–∏—Å–∫ –ø–æ —Å—Ç—Ä–æ–∫–∞–º —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
  - `LIKE`, `ILIKE`;
  - —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π (`~`, `~*`, `!~`, `!~*`);
  - `SIMILAR TO` / `NOT SIMILAR TO`.
- –ü–æ–¥–∑–∞–ø—Ä–æ—Å—ã `ANY / ALL / EXISTS / NOT EXISTS`:
  - –≤—ã–±–æ—Ä ¬´–ª–µ–≤–æ–≥–æ¬ª –ø–æ–ª—è, —Ç–∞–±–ª–∏—Ü—ã –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞ –∏ –ø–æ–ª—è –≤ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–µ;
  - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π mini-`WHERE` –¥–ª—è –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞.

**–ê–≥—Ä–µ–≥–∞—Ü–∏—è –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞:**

- –†–µ–∂–∏–º—ã `GROUP BY`, `ROLLUP`, `CUBE` –∏ `GROUPING SETS` —Å –≤—ã–±–æ—Ä–æ–º –¥–æ —Ç—Ä—ë—Ö —É—Ä–æ–≤–Ω–µ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏.
- –ê–≥—Ä–µ–≥–∞—Ç—ã `COUNT`, `SUM`, `AVG`, `MIN`, `MAX` —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –ø—Å–µ–≤–¥–æ–Ω–∏–º–∞ `agg_value`.
- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `HAVING` (–Ω–∞ –æ—Å–Ω–æ–≤–µ `HavingBuilderWidget`) ‚Äî —É—Å–ª–æ–≤–∏—è –ø–æ –∞–≥—Ä–µ–≥–∞—Ç–∞–º —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π, —á—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å —á–∏—Å–ª–æ–º.
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π `ORDER BY`: –≤ –∞–≥—Ä–µ–≥–∞—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ –º–æ–∂–Ω–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≥—Ä—É–ø–ø–∏—Ä—É—é—â–∏–º –ø–æ–ª—è–º –∏ –ø–æ `agg_value`.

**CASE –∏ —Ä–∞–±–æ—Ç–∞ —Å NULL:**

–û—Ç–¥–µ–ª—å–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ **¬´CASE / NULL¬ª** –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ SQL –¥–æ–±–∞–≤–ª—è—Ç—å –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã:

- **CASE**:
  - –≤—ã–±–æ—Ä –∫–æ–ª–æ–Ω–∫–∏, –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∏ –∑–Ω–∞—á–µ–Ω–∏–π (–≤ —Ç.—á. `BETWEEN`);
  - —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è `CASE WHEN ... THEN '...' ELSE '...' END AS alias`;
  - –∑–Ω–∞—á–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è, –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑ `WhereBuilderWidget`.
- **COALESCE**:
  - –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ `NULL` —Å —É—á–µ—Ç–æ–º —Ç–∏–ø–∞ –∫–æ–ª–æ–Ω–∫–∏;
  - –∞–≤—Ç–æ-alias –≤–∏–¥–∞ `<col>_coalesce`.
- **NULLIF**:
  - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ `NULL`;
  - –∞–≤—Ç–æ-alias –≤–∏–¥–∞ `<col>_nullif`.

–í—Å–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `SELECT`, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

**–°—Ç—Ä–æ–∫–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–ø—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å):**

–ü–∞–Ω–µ–ª—å ¬´–°—Ç—Ä–æ–∫–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏¬ª –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–µ —Å—Ç–æ–ª–±—Ü—ã –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π:

- `UPPER`, `LOWER`, `TRIM`;
- `SUBSTRING(col FROM start FOR length)`;
- `LPAD` / `RPAD` (–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –¥–æ –Ω—É–∂–Ω–æ–π –¥–ª–∏–Ω—ã —É–∫–∞–∑–∞–Ω–Ω—ã–º —Å–∏–º–≤–æ–ª–æ–º);
- `CONCAT` ‚Äî —Å–∫–ª–µ–π–∫–∞ –¥–≤—É—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º.

–†–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü (`alias` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏).

**–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤:**

–°–≤–µ—Ä—Ö—É –µ—Å—Ç—å –ø–∞–Ω–µ–ª—å ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π SELECT –∫–∞–∫¬ª:

- **VIEW** ‚Äî —Å–æ–∑–¥–∞—ë—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç –æ–±—ã—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.
- **MATERIALIZED VIEW** ‚Äî —Å–æ–∑–¥–∞—ë—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ (`CREATE MATERIALIZED VIEW`).
- **CTE** ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–π `SELECT` –∫–∞–∫ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π CTE –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º —Å–ª–æ–≤–∞—Ä–µ `GLOBAL_SAVED_CTES`.

---

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–∏–ø—ã

–û–∫–Ω–æ **¬´–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–∏–ø—ã¬ª** –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–∏–ø—ã –≤ —Å—Ö–µ–º–µ (`ENUM` –∏ `COMPOSITE`);
- —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ ENUM-—Ç–∏–ø—ã —Å –Ω–∞–±–æ—Ä–æ–º –∑–Ω–∞—á–µ–Ω–∏–π;
- –¥–æ–±–∞–≤–ª—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ ENUM;
- —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–æ—Å—Ç–∞–≤–Ω—ã–µ —Ç–∏–ø—ã (—Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π –∏ –∏—Ö —Ç–∏–ø–æ–≤);
- —É–¥–∞–ª—è—Ç—å —Ç–∏–ø—ã —Å –≤—ã–±–æ—Ä–æ–º —Ä–µ–∂–∏–º–∞ `RESTRICT` / `CASCADE`.

–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è ENUM –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤–µ—Ä—Å–∏—è —Å–µ—Ä–≤–µ—Ä–∞ PostgreSQL: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `ALTER TYPE ... DROP VALUE` –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ —Å –≤–µ—Ä—Å–∏–∏ 16, –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –≤–µ—Ä—Å–∏—è –Ω–∏–∂–µ.

---

### –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ CTE

–û–∫–Ω–æ **¬´–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ CTE¬ª** (`ViewsWindow`) ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –æ–±—ä–µ–∫—Ç–æ–≤ —Å—Ö–µ–º—ã `public`:

- —Å–ª–µ–≤–∞: —Å–ø–∏—Å–æ–∫ VIEW, MATERIALIZED VIEW –∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö CTE;
- —Å–ø—Ä–∞–≤–∞: –≤–∫–ª–∞–¥–∫–∏:
  - **¬´–°—Ç—Ä—É–∫—Ç—É—Ä–∞¬ª** ‚Äî —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ —Ç–∏–ø–æ–≤;
  - **¬´SQL / –∑–∞–ø—Ä–æ—Å¬ª** ‚Äî —Ç–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ `SELECT` / –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è;
  - **¬´–î–∞–Ω–Ω—ã–µ¬ª** ‚Äî —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è/CTE.
- –∫–Ω–æ–ø–∫–∏:
  - ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª ‚Äî –ø–µ—Ä–µ—á–∏—Ç–∞—Ç—å —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤;
  - ¬´–°–æ–∑–¥–∞—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä CTE¬ª ‚Äî –æ—Ç–∫—Ä—ã—Ç—å `CteBuilderWindow` –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–π CTE –≤ –æ–±—â–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ;
  - ¬´REFRESH MATERIALIZED VIEW¬ª ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è;
  - ¬´–£–¥–∞–ª–∏—Ç—å VIEW / MAT VIEW¬ª ‚Äî —É–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç.

---

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

–í—Å–µ –∫–ª—é—á–µ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–∏—à—É—Ç—Å—è –≤ –ª–æ–≥–≥–µ—Ä `app` –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥ `app/log/logs` (—Ñ–∞–π–ª –≤–∏–¥–∞ `app_YYYY-MM-DD.log`).

–õ–æ–≥–∏—Ä—É—é—Ç—Å—è:

- —É—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ –ë–î;
- –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ DDL –∏ –∫—Ä—É–ø–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π;
- –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ DataWindow –∏ –¥—Ä—É–≥–∏—Ö –æ–∫–æ–Ω.

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –¥–∏–∞–ª–æ–≥–æ–≤—ã–µ –æ–∫–Ω–∞ `QMessageBox`, –∞ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ª–æ–≥-—Ñ–∞–π–ª–µ.

---

## –ü—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è —Ä–∞–±–æ—Ç—ã

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.
2. –ù–∞–∂–∞—Ç—å **¬´–°–±—Ä–æ—Å–∏—Ç—å –±–∞–∑—É¬ª**, —á—Ç–æ–±—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –¥–µ–º–æ-—Å—Ö–µ–º—É –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.
3. –ß–µ—Ä–µ–∑ **¬´–ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä¬ª** –æ—Ç–∫—Ä—ã—Ç—å —Ç–∞–±–ª–∏—Ü—É `clients` –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤.
4. –û—Ç–∫—Ä—ã—Ç—å **¬´–ü–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ¬ª**, –≤—ã–±—Ä–∞—Ç—å `clients INNER JOIN stays` –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç—á—ë—Ç –ø–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—é –∫–ª–∏–µ–Ω—Ç–æ–≤:
   - –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ –∑–∞–µ–∑–¥–∞;
   - —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∫–ª–∏–µ–Ω—Ç—É –∏ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏–π;
   - –¥–æ–±–∞–≤–∏—Ç—å `CASE`-—Å—Ç–æ–ª–±–µ—Ü —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π –∫–ª–∏–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´VIP¬ª, ¬´–ù–æ–≤—ã–π¬ª).
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫–∞–∫ `VIEW` –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É/–¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ **¬´–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ CTE¬ª**.

---

## üë©‚Äçüíª –ê–≤—Ç–æ—Ä—ã

- –ì–æ–Ω—á–∞—Ä–æ–≤–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞, –≠–§–ë–û-03-24  
- –ï–º–µ–ª—å—è–Ω–æ–≤–∞ –î–∞—Ä—å—è, –≠–§–ë–û-03-24  
- –î–æ—Å—å–∫–æ–≤–∞ –ú–∞—Ä–∏—è, –≠–§–ë–û-03-24  
- –ñ—É–ª–µ–≤–∞ –î–∞—Ä—å—è, –≠–§–ë–û-03-24  
